<style>
    table {
        margin-top: 22px;
    }
    .dark {
        background-color: #633E56; 
        color: white;
        text-align: center;}

    .odd {
        background-color: #84B07F;
    }

    td {
        padding: 3px 22px;
    }

    .total {
        border-top: 2px solid #333;
        font-weight: bold;
    }

    .perf_total {
        font-weight: bold;
        font-style: italic;
    }

    .total td {
        border-top: 2px solid #333;
    }
    .perf_total td {
        border-top: 1px solid #333;
    }
</style>
<h2>Will Call - <%= @show.title %></h2>
<table cellpadding=0 cellspacing=0 >
    <% total = 0 %>
    <% @show.performances.each do |p| %>
            <% perf_total = 0 %>
        <tr>
            <td colspan='7' class='dark'><%= p.date_string %></td>
            <% i = 0 %>
            <% p.tickets.each do |t| %>
                <% if t.cart.purchased_at? %>
                    <tr class='<%= i % 2 ==0 ? 'even':'odd' %>'>
                        <td><%= t.cart.placed_at %></td>
                        <td><%= t.cart.order_firstname %> </td>
                        <td><%= t.cart.order_lastname %></td>
                        <td><%= t.cart.order_email %></td>
                        <td><%= t.quantity %></td>
                        <td><%= t.cart.payment_type %></td>
                        <td><%= render :partial=>'address', :locals => {:payment_notification => t.cart.payment_notification} %></td>
                        <% total += t.quantity %>
                        <% perf_total += t.quantity %>
                    </tr>
                    <% i+=1 %>
                <% end %>
            <% end %>
            <tr class='perf_total'>
                <td colspan='6'><%= p.date_string %> Total</td>
                <td><%= perf_total %></td>
            </tr>
        </tr>
    <% end %>
    <tr class='total'>
        <td colspan='6'>Show Total</td>
        <td><%= total %></td>
    </tr>
</table>
